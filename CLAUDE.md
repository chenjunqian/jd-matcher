# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

JD-Matcher is a Telegram bot that matches job descriptions with user resumes using LLM embeddings. It crawls job listings from multiple sources (RemoteOk, WeWorkRemotely), generates embeddings for job descriptions, and notifies users when matching jobs are found.

## Architecture

### Core Layers (from main.go to services)

1. **main.go** - Entry point that imports `internal/packed` and initializes `cmd.Main`
2. **internal/cmd/cmd.go** - Registers components and starts the GoFrame HTTP server
3. **internal/service/** - Business logic layer with several sub-packages:

### Service Packages

- **jobs/** - Cron jobs that run periodically:
  - `StartRemoteOkMainPageJob` - Crawls RemoteOk for jobs
  - `StartWeWorkRemotelyParseJob` - Crawls WeWorkRemotely for jobs
  - `StartEmbeddingJobDetailJob` - Generates embeddings for job descriptions using pgvector
  - `StartFindMatchJobByResumeJob` - Matches user resumes with job embeddings
  - `StartNotifyUserMatchedJob` - Sends Telegram notifications to users

- **llm/** - LLM integration:
  - Uses OpenAI for embeddings and DeepSeek for match reasoning
  - Prompts defined in `resource/prompt/resume_match.md`

- **telegram/** - Telegram bot handlers:
  - Handles commands (`/start`, `/job`, `/expectation`, etc.)
  - Processes resume file uploads
  - Manages callback queries for job browsing

- **crawler/** - Web scrapers:
  - RemoteOk and WeWorkRemotely crawlers
  - Outputs `CommonJob` struct with standardized job data

### Data Layer

- **internal/dao/** - Database operations (auto-generated by GoFrame)
- **internal/model/entity/** - Database entity models (auto-generated)
- **internal/model/dto/** - Data transfer objects

### Database Schema

PostgreSQL with **pgvector** extension for embeddings:
- `job_detail` - Stores job postings with `job_desc_embedding` (vector)
- `user_info` - Stores user profiles with `resume_embedding` (vector)
- `user_matched_job` - Many-to-many relationship with match scores

## Configuration

Environment variables and config files:
- `hack/config.yaml` - GoFrame CLI configuration
- Environment variables prefixed with `telegram.`, `llm.openai.`, `llm.deepseek.`

## Key Dependencies

- **GoFrame v2** - Full-stack framework (CLI, ORM, HTTP server, cron)
- **go-telegram/bot** - Telegram Bot API wrapper
- **langchaingo** - LLM integration (OpenAI, DeepSeek)
- **pgvector-go** - Vector similarity search for embeddings
- **anaskhan96/soup** - HTML scraping for job crawlers
